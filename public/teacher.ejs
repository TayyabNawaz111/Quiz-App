<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Teacher Dashboard</title>
  </head>
  <body>
    <h1>Teacher Dashboard</h1>
    <div id="create-quiz">
      <h2>Create a Quiz</h2>
      <form id="quiz-form">
        <div id="questions-container">
          <!-- Questions will be added here -->
        </div>
        <button type="submit">Create Quiz</button>
      </form>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const quizForm = document.getElementById("quiz-form");
        const questionsContainer = document.getElementById(
          "questions-container"
        );

        function addQuestionField() {
          const questionDiv = document.createElement("div");
          questionDiv.classList.add("question");
          questionDiv.innerHTML = `
                    <input type="text" class="question-text" placeholder="Question" required>
                    <input type="text" class="option" placeholder="Option 1" required>
                    <input type="text" class="option" placeholder="Option 2" required>
                    <input type="text" class="option" placeholder="Option 3" required>
                    <input type="text" class="option" placeholder="Option 4" required>
                    <input type="text" class="correct-answer" placeholder="Correct Answer" required>
                `;
          questionsContainer.appendChild(questionDiv);
        }

        addQuestionField();

        quizForm.addEventListener("submit", (e) => {
          e.preventDefault();

          const questions = [];
          const questionElements = document.querySelectorAll(".question");

          for (let questionElement of questionElements) {
            const questionText =
              questionElement.querySelector(".question-text").value;
            const options = [];
            for (let optionElement of questionElement.querySelectorAll(
              ".option"
            )) {
              options.push(optionElement.value);
            }
            const correctAnswer =
              questionElement.querySelector(".correct-answer").value;

            if (questionText && options.length === 4 && correctAnswer) {
              questions.push({
                question: questionText,
                options: options,
                answer: correctAnswer,
              });
            }
          }

          if (questions.length === 0) {
            alert("Please add at least one question.");
            return;
          }

          fetch("http://localhost:3000/add-quiz", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ questions }),
          })
            .then((response) => response.json())
            .then(() => {
              alert("Quiz created successfully!");
              quizForm.reset();
              questionsContainer.innerHTML = "";
              addQuestionField();
            })
            .catch((error) => {
              console.error("Error:", error);
            });
        });
      });
    </script>
  </body>
</html>
