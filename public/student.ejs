<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Dashboard</title>
</head>
<body>
    <a href="http://localhost:3000/">Back</a>
    <a href="http://localhost:3000/student">Student</a>
    <a href="http://localhost:3000/teacher">Teacher</a>
    <a href="http://localhost:3000/admin">Admin</a>
    <h1>Student Dashboard</h1>
    <div id="quiz-selection">
        <h2>Available Quizzes</h2>
        <div id="quiz-list">
        </div>
    </div>
    <div id="quiz-container" style="display:none;">
        <h2 id="quiz-title"></h2>
        <div id="questions-container"></div>
        <button id="submit-quiz">Submit Quiz</button>
    </div>
    <div id="result-container" style="display:none;">
        <h2>Quiz Result</h2>
        <p id="score"></p>
        <button id="retake-quiz">Retake Quiz</button>
    </div>
</body>
</html>
<script>
    document.addEventListener('DOMContentLoaded', () => {
    console.log('Document loaded and script running.');

    const quizList = document.getElementById('quiz-list');
    const quizContainer = document.getElementById('quiz-container');
    const questionsContainer = document.getElementById('questions-container');
    const submitQuizButton = document.getElementById('submit-quiz');
    const resultContainer = document.getElementById('result-container');
    const scoreElement = document.getElementById('score');
    const retakeQuizButton = document.getElementById('retake-quiz');
    let currentQuiz = null;

    console.log('Fetching quizzes...');
    // Fetch quizzes and display them with start buttons
    fetch('http://localhost:3000/quizzes',{mode:'cors'})
        .then(response => {
            console.log('Response received:', response);
            return response.json();
        })
        .then(quizzes => {
            console.log('Quizzes fetched:', quizzes);
            quizzes.forEach(quiz => {
                const quizDiv = document.createElement('div');
                quizDiv.classList.add('quiz');

                const startButton = document.createElement('button');
                startButton.textContent = 'Start Quiz';
                startButton.addEventListener('click', () => startQuiz(quiz));
                quizDiv.appendChild(startButton);

                quizList.appendChild(quizDiv);
            });
        })
        .catch(error => console.error('Error fetching quizzes:', error));

    // Function to start the quiz
    const startQuiz = (quiz) => {
        console.log('Starting quiz:', quiz);
        currentQuiz = quiz;
        questionsContainer.innerHTML = '';
        currentQuiz.questions.forEach((question, index) => {
            const questionDiv = document.createElement('div');
            questionDiv.classList.add('question');
            const questionText = document.createElement('p');
            questionText.textContent = `${index + 1}. ${question.question}`;
            questionDiv.appendChild(questionText);

            question.options.forEach(option => {
                const optionLabel = document.createElement('label');
                const optionInput = document.createElement('input');
                optionInput.type = 'radio';
                optionInput.name = `question-${index}`;
                optionInput.value = option;
                optionLabel.appendChild(optionInput);
                optionLabel.appendChild(document.createTextNode(option));
                questionDiv.appendChild(optionLabel);
                questionDiv.appendChild(document.createElement('br'));
            });

            questionsContainer.appendChild(questionDiv);
        });

        quizContainer.style.display = 'block';
        resultContainer.style.display = 'none';
    };

    // Event listener to handle form submission
    submitQuizButton.addEventListener('click', () => {
        console.log('Submitting quiz.');
        let score = 0;
        currentQuiz.questions.forEach((question, index) => {
            const selectedOption = document.querySelector(`input[name="question-${index}"]:checked`);
            if (selectedOption && selectedOption.value === question.answer) {
                score++;
            }
        });

        scoreElement.textContent = `You scored ${score} out of ${currentQuiz.questions.length}`;
        quizContainer.style.display = 'none';
        resultContainer.style.display = 'block';
    });

    // Event listener to handle quiz retake
    retakeQuizButton.addEventListener('click', () => {
        console.log('Retaking quiz.');
        quizContainer.style.display = 'none';
        resultContainer.style.display = 'none';
    });
});
// console.log("hello");
</script>